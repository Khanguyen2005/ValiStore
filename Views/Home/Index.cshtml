@model ValiModern.Models.ViewModels.HomeIndexVM
@{
    ViewBag.Title = "Home";
    var banners = Model.Banners;
    var blocks = Model.Blocks;
}

@section Styles {
    <link href="~/Content/Home.css" rel="stylesheet" />
}

<div class="container py-4">
    <!-- Banners carousel -->
    <div id="homeCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
  <div class="carousel-indicators">
       @if (banners != null && banners.Any())
  {
        for (int i = 0; i < banners.Count(); i++)
        {
         <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="@i" class="@(i==0?"active":"")" aria-current="@(i==0?"true":"false")" aria-label="Slide @(i+1)"></button>
    }
         }
        </div>
        <div class="carousel-inner rounded-4 shadow-lg home-banner-wrapper">
@if (banners != null && banners.Any())
 {
                var index = 0;
     foreach (var b in banners)
      {
        <div class="carousel-item @(index==0?"active":"")">
<div class="home-banner-frame">
               <img class="home-banner-img" src="@b.image_url" alt="@b.name" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1553062407-98eeb64c6a62?q=80&w=1200&auto=format&fit=crop';" />
              </div>
  </div>
        index++;
    }
       }
            else
    {
                <div class="carousel-item active">
         <div class="bg-gradient d-flex align-items-center justify-content-center" style="height:400px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <p class="text-white fs-4">No banners available</p>
    </div>
        </div>
   }
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
     </button>
        <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
     <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    @helper ProductGridRow(string title, string link, IEnumerable<ValiModern.Models.ViewModels.ProductCardVM> items)
    {
<section class="mb-5">
   <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h4 fw-bold mb-0 position-relative">
      @title
    <span class="position-absolute bottom-0 start-0 w-50 border-bottom border-3 border-primary"></span>
     </h2>
     <a href="@link" class="btn btn-outline-primary btn-sm d-flex align-items-center gap-1">
  <span>Xem tất cả</span>
           <i class="bi bi-arrow-right"></i>
 </a>
  </div>
       <div class="row g-3 g-md-4">
         @if (items != null && items.Any())
     {
           foreach (var p in items)
   {
  <div class="col-6 col-md-3">
             <div class="product-card card h-100 border-0 shadow-sm">
     <div class="product-img-wrapper position-relative overflow-hidden">
<img class="card-img-top" src="@p.image_url" alt="@p.name"
        onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1553062407-98eeb64c6a62?q=80&w=600&auto=format&fit=crop';" />
 <div class="product-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center">
  <a href="@Url.Action("Details","Product", new { id = p.id })" class="btn btn-light btn-sm rounded-circle">
          <i class="bi bi-eye"></i>
             </a>
</div>
        </div>
       <div class="card-body p-3">
           <h6 class="card-title mb-2 text-truncate fw-semibold" title="@p.name">@p.name</h6>
   <div class="d-flex justify-content-between align-items-center">
        <span class="fw-bold text-primary fs-6">@String.Format("{0:n0}", p.price) VND</span>
 <a href="@Url.Action("Details","Product", new { id = p.id })" class="btn btn-sm btn-outline-primary rounded-pill px-3">
      <i class="bi bi-cart-plus"></i>
         </a>
          </div>
          </div>
         </div>
        </div>
   }
    }
 else
    {
              <div class="col-12">
  <div class="alert alert-info text-center">
    <i class="bi bi-info-circle me-2"></i>Chưa có sản phẩm nào
        </div>
           </div>
         }
 </div>
        </section>
    }

@if (blocks != null)
  {
        foreach (var block in blocks)
        {
 @ProductGridRow(block.CategoryName, Url.Action("Index", "Product", new { category = block.CategoryName }), block.Products)
        }
    }

    <!-- Guide section -->
    <section class="mt-5 pt-4 border-top">
        <div class="text-center mb-4">
   <h2 class="h3 fw-bold mb-2">Hướng dẫn sử dụng & chọn sản phẩm</h2>
            <p class="text-muted">Khám phá các bí quyết để lựa chọn và sử dụng sản phẩm hiệu quả</p>
        </div>
      <div class="row g-4">
       <div class="col-md-4">
         <div class="guide-card position-relative overflow-hidden rounded-4 shadow">
 <img class="w-100 guide-img" src="https://images.unsplash.com/photo-1516762689617-e1cffcef479d?q=80&w=800&auto=format&fit=crop" alt="Guide1"
           onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1553062407-98eeb64c6a62?q=80&w=800&auto=format&fit=crop';" />
          <div class="guide-overlay position-absolute bottom-0 start-0 w-100 p-3 text-white bg-dark bg-opacity-75">
       <h5 class="fw-bold mb-1">Chọn kích thước vali</h5>
              <small>Phù hợp với từng loại chuyến đi</small>
             </div>
    </div>
       </div>
            <div class="col-md-4">
       <div class="guide-card position-relative overflow-hidden rounded-4 shadow">
          <img class="w-100 guide-img" src="https://images.unsplash.com/photo-1512548438457-4c9584d3766c?q=80&w=800&auto=format&fit=crop" alt="Guide2"
        onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1553062407-98eeb64c6a62?q=80&w=800&auto=format&fit=crop';" />
         <div class="guide-overlay position-absolute bottom-0 start-0 w-100 p-3 text-white bg-dark bg-opacity-75">
     <h5 class="fw-bold mb-1">Sắp xếp đồ thông minh</h5>
   <small>Tối ưu không gian và tiện lợi</small>
     </div>
        </div>
      </div>
            <div class="col-md-4">
      <div class="guide-card position-relative overflow-hidden rounded-4 shadow">
        <img class="w-100 guide-img" src="https://images.unsplash.com/photo-1491553895911-0055eca6402d?q=80&w=800&auto=format&fit=crop" alt="Guide3"
      onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1553062407-98eeb64c6a62?q=80&w=800&auto=format&fit=crop';" />
         <div class="guide-overlay position-absolute bottom-0 start-0 w-100 p-3 text-white bg-dark bg-opacity-75">
            <h5 class="fw-bold mb-1">Chăm sóc sản phẩm</h5>
              <small>Giữ gìn và vệ sinh đúng cách</small>
    </div>
       </div>
     </div>
        </div>
    </section>
</div>